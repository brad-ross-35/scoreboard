<!DOCTYPE html>
<html>
	<head>
		<title>Scoreboard</title>

		<link rel="stylesheet" type="text/css" href="./lib/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="./style.css">
	</head>
	<body>
		<script data-template-name="application" type="text/x-handlebars">
			<div class="container">
				<div class="row">
					{{outlet}}
				</div>
			</div>
		</script>

		<script data-template-name="bracketCreation" type="text/x-handlebars">
			<div id="bracket-creation-modal" class="modal fade" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h4 class="modal-title">Configure Bracket</h4>
			      </div>
			      	<form {{action "createBracket" on="submit"}}>
					    <div class="modal-body">
					      	
					      	<div class="form-group">
					        	<label for="numRounds">Number of Rounds</label>
					        	<div>
					        	{{input type="text"
					        			name="numRounds"
					        			value=numRounds
					        			class="form-control"}}
					        	</div>
					        </div>

					        <div class="form-group">
					        	<div class="checkbox">
					        		<label>
					        			Include Bonus Round
					        			{{input type="checkbox"
						        			name="bonusRoundToggle"
						        			checked=bonusRound
						        			}}
						        	</label>
					        	</div>
					        </div>

					        {{#if bonusRound}}
						        <div class="form-group">
						        	<label for="bonusTeamName" class="">Bonus Round Team Name</label>
						        	<div>
						        	{{input type="text"
						        			name="bonusTeamName"
						        			value=bonusTeamName
						        			class="form-control"}}
						        	</div>
						      	</div>
					      	{{/if}}
					    </div>
					    <div class="modal-footer">
							<button type="submit" class="btn btn-primary">Create Bracket</button>
					    </div>
				    </form>
			    </div>
			  </div>
			</div>
		</script>

		<script data-template-name="bracket" type="text/x-handlebars">
			<div id="bracket-view" class="col-xs-8">
				<h1>Bracket:</h1>
				{{#unless isFirstRound}}
					<button {{action "previousRound" target="view"}}>&lt;-</button>
				{{/unless}}
				{{#unless isSecondToLastRound}}
					<button {{action "nextRound" target="view"}}>-&gt;</button>
				{{/unless}}

				<div id="bracket-container" class="row">
					<div id="bracket">
						{{#each round in controller}}
							{{render "round" round}}
						{{/each}}
					</div>
				</div>
			</div>

			<div id="match" class="col-xs-4">
				{{outlet match}}
			</div>
		</script>

		<script data-template-name="round" type="text/x-handlebars">
			<div class="col-xs-6 round">
				<h3 class="text-center">
					{{#if isBonusRound}}
						Bonus Round
					{{else}}
						Round {{id}}
					{{/if}}
				</h3>
				<br>
				{{#each match in matches}}
					{{render "bracketMatch" match}}
				{{/each}}
			</div>
		</script>

		<script data-template-name="bracketMatch" type="text/x-handlebars">
			<div class="row">
			<div class="col-xs-12">
			<div class="panel panel-default" {{action "play" model}}>
				<ul class="list-group">
					{{render "bracketMatchTeam" firstTeam}}
					{{render "bracketMatchTeam" secondTeam}}
				</ul>
			</div>
			</div>
			</div>
		</script>

		<script data-template-name="bracketMatchTeam" type="text/x-handlebars">
			<li {{bind-attr class=":list-group-item teamWon:list-group-item-success"}}>
				{{#if editing}}
					<a class="editTeamNameToggle" {{action "toggleEditing"}}><span class="glyphicon glyphicon-ok"></span></a>
					{{input type="text" value=team.name}}
				{{else}}
					{{#if isFirstRound}}
						<a class="editTeamNameToggle" {{action "toggleEditing"}}><span class="glyphicon glyphicon-pencil"></span></a>
					{{/if}}
					{{#if team}} 
						<strong>{{team.name}}</strong>
					{{else}}
						<em>Undecided</em>
					{{/if}}
				{{/if}}
				<span class="badge">{{score}}</span>
			</li>
		</script>

		<script data-template-name="match" type="text/x-handlebars">
			<h1>Current Match</h1>
			{{render "matchTeam" firstTeam}}
			<p>vs.</p>
			{{render "matchTeam" secondTeam}}
			<p>winner: {{winner.name}}</p>
			<button {{action "finalize"}} {{bind-attr disabled=finalizedOrTie}}>Finalize {{finalized}}</button>
		</script>

		<script data-template-name="matchTeam" type="text/x-handlebars">
			<p>{{team.name}} - {{score}}
				<button {{action "incrementScore"}} {{bind-attr disabled=finalized}}>+</button>
				<button {{action "decrementScore"}} {{bind-attr disabled=finalizedOrScoreIsZero}}>-</button>
			</p>
		</script>

		<script type="text/javascript" src="./lib/jquery-1.11.0.js"></script>
		<script type="text/javascript" src="./lib/handlebars-1.1.2.js"></script>
		<script type="text/javascript" src="./lib/ember-1.4.0.js"></script>
		<script type="text/javascript" src="./lib/ember-data-1.0.0-beta7.js"></script>
		<script type="text/javascript" src="./lib/modernizr.js"></script>
		<script type="text/javascript" src="./lib/bootstrap.min.js"></script>
		<script type="text/javascript" src="./scoreboard.js"></script>
	</body>
</html>
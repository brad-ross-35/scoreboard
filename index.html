<!DOCTYPE html>
<html>
	<head>
		<title>Scoreboard</title>

		<link rel="stylesheet" type="text/css" href="./lib/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="./style.css">
	</head>
	<body>
		<script data-template-name="application" type="text/x-handlebars">
			<div class="container">
				<div class="row">
					{{outlet}}
				</div>
			</div>
		</script>

		<script data-template-name="bracketCreation" type="text/x-handlebars">
			<div id="bracket-creation-modal" class="modal fade" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h4 class="modal-title">Configure Bracket</h4>
			      </div>
			      	<form {{action "createBracket" on="submit"}}>
					    <div class="modal-body">
					      	
					      	<div class="form-group">
					        	<label for="numRounds">Number of Rounds</label>
					        	<div>
					        	{{input type="text"
					        			name="numRounds"
					        			value=numRounds
					        			class="form-control"}}
					        	</div>
					        <div>

					        <br>

					        <div class="form-group">
					        	<div class="checkbox">
					        		<label>
					        			Include Bonus Round
					        			{{input type="checkbox"
						        			name="bonusRoundToggle"
						        			checked=bonusRound
						        			}}
						        	</label>
					        	</div>
					        <div>

					        {{#if bonusRound}}
					        <div class="form-group">
					        	<label for="bonusTeamName" class="">Bonus Round Team Name</label>
					        	<div>
					        	{{input type="text"
					        			name="bonusTeamName"
					        			value=bonusTeamName
					        			class="form-control"}}
					        	</div>
					      	</div>
					      	{{/if}}
					    </div>
					    <div class="modal-footer">
					      	<div class="form-group">
							    <button type="submit" class="btn btn-primary">Create Bracket</button>
						    </div>	   
					    </div>
				    </form>
			    </div>
			  </div>
			</div>
		</script>

		<script data-template-name="bracket" type="text/x-handlebars">
			<div id="bracket" class="col-xs-8">
				<h1>Bracket:</h1>
				{{#link-to "round" previousRound disabled=isFirstRound}}&lt;-{{/link-to}}
				{{#link-to "round" nextRound disabled=isSecondToLastRound}}-&gt;{{/link-to}}
				<div class="row">
					<div class="col-xs-6">
					{{outlet currentRound}}
					</div>
					<div class="col-xs-6">
					{{outlet nextRound}}
					</div>
				</div>
			</div>
			<div id="match" class="col-xs-4">
			{{outlet match}}
			</div>
		</script>

		<script data-template-name="round" type="text/x-handlebars">
			{{#if model}}<h3 class="text-center">Round {{id}}</h3>{{/if}}
			<br>
			{{#each match in matches}}
				{{render "bracketMatch" match}}
			{{/each}}
		</script>

		<script data-template-name="bracketMatch" type="text/x-handlebars">
			<div class="row">
			<div class="col-xs-12">
			<div class="panel panel-default" {{action "play" model}}>
				<ul class="list-group">
					<li {{bind-attr class=":list-group-item firstTeamWon:list-group-item-success"}}>
						{{#if editingFirstTeamName}}
							<a class="editTeamNameToggle" {{action "toggleEditing" 2 bubbles=false}}><span class="glyphicon glyphicon-ok"></span></a>
							{{input type="text" value=firstTeam.name}}
						{{else}}
							{{#if isFirstRound}}
								<a class="editTeamNameToggle" {{action "toggleEditing" 0 bubbles=false}}><span class="glyphicon glyphicon-pencil"></span></a>
							{{/if}}
							{{#if firstTeam}} 
								<strong>{{firstTeam.name}}</strong>
							{{else}}
								<em>Undecided</em>
							{{/if}}
						{{/if}}
						<span class="badge">{{firstTeamScore}}</span>
					</li>
					<li {{bind-attr class=":list-group-item secondTeamWon:list-group-item-success"}}>
						{{#if editingSecondTeamName}}
							<a class="editTeamNameToggle" {{action "toggleEditing" 2 bubbles=false}}><span class="glyphicon glyphicon-ok"></span></a>
							{{input type="text" value=secondTeam.name}}
						{{else}}
							{{#if isFirstRound}}
								<a class="editTeamNameToggle" {{action "toggleEditing" 1 bubbles=false}}><span class="glyphicon glyphicon-pencil"></span></a>
							{{/if}}
							{{#if secondTeam}} 
								<strong>{{secondTeam.name}}</strong>
							{{else}}
								<em>Undecided</em>
							{{/if}}
						{{/if}}
						<span class="badge">{{secondTeamScore}}</span>
					</li>
				</ul>
			</div>
			</div>
			</div>
		</script>

		<script data-template-name="match" type="text/x-handlebars">
		<h1>Current Match</h1>
		<p>{{firstTeam.name}} - {{firstTeamScore}}
			<button {{action "incrementScore" 0}} {{bind-attr disabled=finalized}}>+</button>
			<button {{action "decrementScore" 0}} {{bind-attr disabled=finalizedOrFirstTeamScoreIsZero}}>-</button></p>
		<p>vs.</p>
		<p>{{secondTeam.name}} - {{secondTeamScore}}
			<button {{action "incrementScore" 1}} {{bind-attr disabled=finalized}}>+</button>
			<button {{action "decrementScore" 1}} {{bind-attr disabled=finalizedOrSecondTeamScoreIsZero}}>-</button></p>
		<p>winner: {{winner.name}}</p>
		<button {{action "finalize" id}} {{bind-attr disabled=finalizedOrTie}}>Finalize {{finalized}}</button>
		</script>

		<script type="text/javascript" src="./lib/jquery-1.11.0.js"></script>
		<script type="text/javascript" src="./lib/handlebars-1.1.2.js"></script>
		<script type="text/javascript" src="./lib/ember-1.4.0.js"></script>
		<script type="text/javascript" src="./lib/ember-data-1.0.0-beta7.js"></script>
		<script type="text/javascript" src="./lib/bootstrap.min.js"></script>
		<script type="text/javascript" src="./scoreboard.js"></script>
	</body>
</html>